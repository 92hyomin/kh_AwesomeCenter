<?xml version="1.0" encoding="UTF-8"?>


<!-- ====  mapper 기본설정 ==== -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 루트 엘리먼트 & 네임스페이스 설정(프로젝트 전체 내에서 유일해야 한다.) -->
<mapper namespace="awesomeMember">
	
	<!-- 관심분야 카테고리 번호 채번 -->
	<select id="getCategoryNo" parameterType="String" resultType="String">
		select cate_no_fk
		from wishcategory
		where userno_fk = #{userno}
	</select>
	
	<!-- 채번한 번호로 관심분야 조회 -->
	<select id="getWishCategoryList" parameterType="HashMap" resultType="com.center.member.model.CategoryVO">
		select cate_name, cate_code
		from lec_category
		where cate_no in 
		<foreach collection="noArr" index="i" open="(" separator="," close=")">
			${noArr[i]}
		</foreach>	
	</select>
	
	<!-- 카테고리 목록 가져오기 -->
	<select id="getCategoryList" resultType="com.center.member.model.CategoryVO">
		select cate_no, cate_name, cate_code
		from lec_category
	</select>
	
	<!-- 마케팅 수신동의 변경 -->
	<update id="editMarketing" parameterType="HashMap">
		update awesome_member set marketing_email = #{emailCheck}, marketing_sms = #{smsCheck} where userno = #{userno}
	</update>
	
	<!-- 관심 분야 변경 -->
	<delete id="deleteWishCategory" parameterType="String">
		delete from wishcategory
		where userno_fk = #{userno}
	</delete>
	<insert id="insertWishCategory" parameterType="HashMap">
		insert into wishcategory(userno_fk, cate_no_fk)
		values(#{userno}, #{cateno})
	</insert>
	
	<select id="loginMember" resultType="com.center.member.model.MemberVO">
		select userno, userid, userpw, username, rrn1, rrn2, post, addr1, addr2, hp1, hp2, hp3, email, marketing_sms, marketing_email, 
				to_char(registerday, 'yyyy.mm.dd') as registerday, to_char(editday, 'yyyy.mm.dd') as editday,
				to_char(lastloginday, 'yyyy.mm.dd') as lastloginday, status
		from awesome_member
		where userno=2 
	</select>

<!-- 효민 -->
	<select id="idCheck" parameterType="String" resultType="Integer">
		select count(*) 
		from   awesome_member 
		where  userid= #{userid}
	</select>
	
	<insert id="insertUser" parameterType="HashMap">
		insert into AWESOME_MEMBER(USERNO, USERID, USERPW, USERNAME, RRN1, RRN2, POST, ADDR1, ADDR2, 
		                           HP1, HP2, HP3, EMAIL, MARKETING_SMS, MARKETING_EMAIL)
		values      (SEQ_AWESOME_MEMBER.nextval, #{userid}, #{userpwd}, #{userName}, #{ResidentNum1}, 
		            #{ResidentNum2}, #{post_code}, #{post_address1}, #{post_address2}, #{celphone_no1}, 
		            #{celphone_no2}, #{celphone_no3}, #{user_email}, #{marketingEmail}, #{marketingSMS})
	</insert>
	
	<select id="isExistUser" parameterType="HashMap" resultType="com.center.member.model.MemberVO">
		select userno, userid, userpw, username, rrn1, rrn2, post, addr1, addr2, hp1, hp2, hp3, email, marketing_sms, marketing_email, 
				to_char(registerday, 'yyyy-mm-dd') as registerday, to_char(editday, 'yyyy-mm-dd') as editday,
				to_char(lastloginday, 'yyyy-mm-dd') as lastloginday, status
		from   awesome_member
		where  userid= #{userid} and userpw = #{userpwd} and status = 1
	</select>
	
<!-- 효민 끝-->
</mapper>